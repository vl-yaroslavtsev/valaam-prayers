<template>
	<div class="page">

		<div class="navbar">
			<div class="navbar-bg"></div>
			<div class="navbar-inner sliding">
				<div class="left">
					<a href="#" class="link back">
						<i class="icon icon-back"></i>
						<span class="">Назад</span>
					</a>
				</div>
				<div class="title">{{#if searchMode}}Поиск{{else}}Мысли{{/if}}</div>
				<div class="right">
					{{#if searchMode}}
					<!--<a class="link popup-close">Закрыть</a>-->
					{{else}}
						{{> "navbar-right"}}
					{{/if}}
				</div>
				<div class="navbar-extra">
					<div class="navbar-extra-subtitle">Мысль дня</div>
		      <div class="navbar-extra-title">{{thoughts.picture_desc}}</div>
				</div>
			</div>
		</div>

		{{> "read-mode-toolbar"}}

		<div class="page-content">
			{{#if thoughts.text}}
			<h2 class="block">{{thoughts.picture_desc}}</h2>
			<div class="block block-strong inset text-content">
				{{#if thoughts.picture}}
				<img class="lazy"
					data-src="{{thoughts.picture}}"
					data-src-full="{{thoughts.picture_full}}"
					>
				{{/if}}
					<!-- data-srcset="{{thoughts.picture_srcset}}"
					sizes="45vw" -->
				{{thoughts.text}}
				<div style="clear: both;"></div>
			</div>
			{{/if}}
		</div>

	</div>
</template>
<style scoped>
	img {
		/* width: 100%; */
		max-width: 45%;
		float: left;
		padding-right: 10px;
	}
</style>
<!--suppress JSAnnotator -->
<script>
	import { getUrl } from '../js/image-manager.js';
	import readModeMixin from './read-mode-mixin.js';

	export default {
		async data() {
			let dayCode = this.$route.params.id,
					dayData = {},
					prayers = this.day.prayers;

			dayData.thoughts = Object.assign({}, prayers);

			if (dayData.thoughts.picture) {
				dayData.thoughts.picture = await getUrl({
					s: prayers.picture,
					m: prayers.picture_2x
				});
				dayData.thoughts.picture_full = await getUrl({
					s: prayers.picture_3x,
					sOffline: prayers.picture,
					mOffline: prayers.picture_2x
				});
			}

			dayData.searchMode = this.$route.query.mode === 'search';

			return dayData;
		},
		mixins: [readModeMixin]
	};
</script>
